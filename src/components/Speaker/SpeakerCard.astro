---
const { p } = Astro.props;
import { Image, getImage } from "astro:assets";
import NoImage from "../../../public/image/logo-tepcot.jpg";
const bgImage = await getImage({ src: NoImage });

const imageUrl =
  p._embedded?.["wp:featuredmedia"]?.[0]?.media_details?.sizes?.medium
    ?.source_url || p._embedded?.["wp:featuredmedia"]?.[0]?.source_url;
---

<article
  class="relative h-full overflow-hidden rounded-2xl bg-white ring-1 ring-blue-900/30 shadow-sm transition-all duration-200 ease-out hover:shadow-lg"
>
  <!-- Cover -->
  <div class="relative h-20 sm:h-24 overflow-hidden">
    <div
      class="absolute inset-0 bg-center bg-cover bg-no-repeat blur-xl bg-black scale-110"
      style={`background-image: url('${imageUrl}')`}
    >
      <div
        class="absolute inset-0 opacity-20"
        style="background-image: radial-gradient(circle at 18% 35%, rgba(255,255,255,.55) 0 2px, transparent 2px), radial-gradient(circle at 70% 60%, rgba(255,255,255,.45) 0 2px, transparent 2px);"
      >
      </div>
    </div>
    <div class="absolute inset-0 bg-gradient-to-b from-black/0 to-black/10">
    </div>
  </div>

  <!-- Body: สำคัญมาก -> flex-col + h-full เพื่อดันปุ่มลงล่าง -->
  <div
    class="relative px-4 pb-4 flex h-[calc(100%-5rem)] sm:h-[calc(100%-6rem)] flex-col"
  >
    <!-- Avatar row -->
    <div class="-mt-10 sm:-mt-12 flex items-center justify-between">
      <div
        class="h-24 w-24 sm:h-32 sm:w-32 rounded-full bg-gradient-to-t from-blue-800 to-blue-500 ring-4 ring-white overflow-hidden shadow-xl mx-auto"
      >
        <img
          src={imageUrl}
          alt={p.name}
          class="h-full w-full object-cover transition-transform duration-200 ease-out hover:scale-95"
        />
      </div>
    </div>

    <!-- Content -->
    <div class="mt-6 mx-auto">
      <h2 class="text-24 md:text-30 text-center -mb-1 text-slate-500 line-clamp-1">
        {p.title.rendered}
      </h2>

      <h3
        class="text-normal font-semibold line-clamp-2 text-center"
      >
        {p.acf.career}
      </h3>

      <h4
        class="mt-1 text-a-blue-021430/80 font-light line-clamp-2 min-h-[56px] text-center"
      >
        {p.acf.company}
      </h4>
    </div>

    <!-- CTA: ดันลงล่าง + ให้ปุ่มเท่ากันทุกการ์ด -->
    <!-- <div class="mt-auto pt-4">
      <a
        href={`/speakers/${p.slug}`}
        class="text-sm text-slate-500 line-clamp-1"
      >
        <button
          class="btn btn-sm btn-outline btn-primary w-full text-20"
          @click="emit('connect', p)"
        >
          View Profile
        </button>
      </a>
    </div> -->
  </div>
</article>

<style scoped>
  @import "../../styles/global.css";

  .card {
    color: var(--black);
    overflow: hidden;
  }

  .card .card-top {
    /* position: relative; */
    overflow: hidden;
  }
  .card .card-top img {
    object-fit: contain;
    height: 200px;
    width: 100%;
    transform: scale(1);
    transition: transform 0.5s ease;
  }

  .card:hover .card-top img {
    transform: scale(1.2);
    transition: transform 0.5s ease;
  }

  .card .card-title {
    /* line-height: 2.5rem; */
  }

  .card:hover .card-title,
  .card:hover {
    color: var(--black);
  }

  .card-content p {
    line-height: 1.2;
    margin-bottom: 0 !important;
  }

  @media (max-width: 1023px) {
    .card .card-top img {
      object-fit: contain;
      height: 160px;
      width: 100%;
      transform: scale(1);
      transition: transform 0.5s ease;
    }
  }

  @media only screen and (max-width: 767px) {
    .is-desktop {
      display: none;
    }
    .card {
      border-radius: 7.5px;
    }
    .card .card-top img {
      height: 145px;
    }
  }

  @media only screen and (min-width: 768px) and (max-width: 1023px) {
    .is-desktop {
      display: none;
    }
  }

  @media only screen and (min-width: 1024px) {
    .is-mobile {
      display: none;
    }
  }
</style>
